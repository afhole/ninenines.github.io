<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Loïc Hoguin based on a design from (Soft10) Pol Cámara">

    <title>Nine Nines: gun(3)</title>

    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic' rel='stylesheet' type='text/css'>
    <link href="/css/99s.css?r=1" rel="stylesheet">

    <link rel="shortcut icon" href="/img/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/img/ico/apple-touch-icon-114.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/img/ico/apple-touch-icon-72.png">
    <link rel="apple-touch-icon-precomposed" href="/img/ico/apple-touch-icon-57.png">

    
</head>


<body class="">
  <header id="page-head">
    <div id="topbar" class="container">
        <div class="row">
          <div class="span2">
            <h1 id="logo"><a href="/" title="99s">99s</a></h1>
          </div>
          <div class="span10">
            
            <div id="side-header">
              <nav>
                <ul>
                  <li><a title="Hear my thoughts" href="/articles">Articles</a></li>
  				  <li><a title="Watch my talks" href="/talks">Talks</a></li>
  				  <li class="active"><a title="Read the docs" href="/docs">Documentation</a></li>
  				  <li><a title="Request my services" href="/services">Consulting & Training</a></li>
                </ul>
              </nav> 
              <ul id="social">
                <li>
                  <a href="https://github.com/ninenines" title="Check my Github repositories"><img src="/img/ico_github.png" data-hover="/img/ico_github_alt.png" alt="Github"></a>
                </li>
                    <li>
						<a title="Contact me" href="mailto:contact@ninenines.eu"><img src="/img/ico_mail.png" data-hover="/img/ico_mail_alt.png"></a>
					</li>
              </ul>
            </div>
          </div>
        </div>
    </div>


</header>

<div id="contents" class="two_col">
<div class="container">
<div class="row">
<div id="docs" class="span9 maincol">

<h1 class="lined-header"><span>gun(3)</span></h1>

<div class="sect1">
<h2 id="_name">Name</h2>
<div class="sectionbody">
<div class="paragraph"><p>gun - Asynchronous HTTP client</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph"><p>The <code>gun</code> module provides an asynchronous interface for
connecting and communicating with Web servers over HTTP,
HTTP/2 or Websocket.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_exports">Exports</h2>
<div class="sectionbody">
<div class="paragraph"><p>Connection:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="../gun.open">gun:open(3)</a> - Open a connection to the given host and port
</p>
</li>
<li>
<p>
<a href="../gun.open_unix">gun:open_unix(3)</a> - Open a connection to the given Unix domain socket
</p>
</li>
<li>
<p>
<a href="../gun.close">gun:close(3)</a> - Brutally close the connection
</p>
</li>
<li>
<p>
<a href="../gun.info">gun:info(3)</a> - Obtain information about the connection
</p>
</li>
</ul></div>
<div class="paragraph"><p>Requests:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="../gun.get">gun:get(3)</a> - Get a resource representation
</p>
</li>
<li>
<p>
<a href="../gun.head">gun:head(3)</a> - Get headers of a resource representation
</p>
</li>
<li>
<p>
<a href="../gun.options">gun:options(3)</a> - Query the capabilities of the server or a resource
</p>
</li>
<li>
<p>
<a href="../gun.patch">gun:patch(3)</a> - Apply a set of changes to a resource
</p>
</li>
<li>
<p>
<a href="../gun.post">gun:post(3)</a> - Process the enclosed representation according to a resource&#8217;s own semantics
</p>
</li>
<li>
<p>
<a href="../gun.put">gun:put(3)</a> - Create or replace a resource
</p>
</li>
<li>
<p>
<a href="../gun.delete">gun:delete(3)</a> - Delete a resource
</p>
</li>
<li>
<p>
<a href="../gun.request">gun:request(3)</a> - Perform the given request
</p>
</li>
<li>
<p>
<a href="../gun.data">gun:data(3)</a> - Stream the body of a request
</p>
</li>
</ul></div>
<div class="paragraph"><p>Messages:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="../gun.await">gun:await(3)</a> - Wait for a response
</p>
</li>
<li>
<p>
<a href="../gun.await_body">gun:await_body(3)</a> - Wait for the complete response body
</p>
</li>
<li>
<p>
<a href="../gun.await_up">gun:await(3)</a> - Wait for the connection to be up
</p>
</li>
<li>
<p>
<a href="../gun.flush">gun:flush(3)</a> - Flush all messages related to a connection or a stream
</p>
</li>
</ul></div>
<div class="paragraph"><p>Streams:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="../gun.cancel">gun:cancel(3)</a> - Cancel the given stream
</p>
</li>
</ul></div>
<div class="paragraph"><p>Websocket:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="../gun.ws_upgrade">gun:ws_upgrade(3)</a> - Upgrade to Websocket
</p>
</li>
<li>
<p>
<a href="../gun.ws_send">gun:ws_send(3)</a> - Send Websocket frames
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_messages">Messages</h2>
<div class="sectionbody">
<div class="paragraph"><p>Gun will inform the calling process of events asynchronously
by sending any of the following messages:</p></div>
<div class="paragraph"><p>Connection:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="../gun_up">gun_up(3)</a> - The connection is up
</p>
</li>
<li>
<p>
<a href="../gun_down">gun_down(3)</a> - The connection is down
</p>
</li>
<li>
<p>
<a href="../gun_upgrade">gun_upgrade(3)</a> - Successful protocol upgrade
</p>
</li>
<li>
<p>
<a href="../gun_error">gun_error(3)</a> - Stream or connection-wide error
</p>
</li>
</ul></div>
<div class="paragraph"><p>Responses:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="../gun_push">gun_push(3)</a> - Server-initiated push
</p>
</li>
<li>
<p>
<a href="../gun_inform">gun_inform(3)</a> - Informational response
</p>
</li>
<li>
<p>
<a href="../gun_response">gun_response(3)</a> - Response
</p>
</li>
<li>
<p>
<a href="../gun_data">gun_data(3)</a> - Response body
</p>
</li>
<li>
<p>
<a href="../gun_trailers">gun_trailers(3)</a> - Response trailers
</p>
</li>
</ul></div>
<div class="paragraph"><p>Websocket:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="../gun_ws">gun_ws(3)</a> - Websocket frame
</p>
</li>
</ul></div>
<div class="paragraph"><p>The response messages will be sent to the process that opened
the connection by default. The <code>reply_to</code> request option can
be used to redirect request-specific messages to a different
process.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_types">Types</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_http_opts">http_opts()</h3>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">http_opts</span></span>() <span style="color: #990000">::</span> #{
    <span style="color: #0000FF">keepalive</span>             <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000000">timeout</span></span>(),
    <span style="color: #0000FF">transform_header_name</span> <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #0000FF">fun</span></span>((<span style="font-weight: bold"><span style="color: #000080">binary</span></span>()) <span style="color: #990000">-&gt;</span> <span style="font-weight: bold"><span style="color: #000080">binary</span></span>()),
    <span style="color: #0000FF">version</span>               <span style="color: #990000">=&gt;</span> <span style="color: #FF6600">'HTTP/1.1'</span> | <span style="color: #FF6600">'HTTP/1.0'</span>
}</tt></pre></div></div>
<div class="paragraph"><p>Configuration for the HTTP protocol.</p></div>
<div class="paragraph"><p>The default value is given next to the option name:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
keepalive (5000)
</dt>
<dd>
<p>
Time between pings in milliseconds. Since the HTTP protocol has
no standardized way to ping the server, Gun will simply send an
empty line when the connection is idle. Gun only makes a best
effort here as servers usually have configurable limits to drop
idle connections. Use <code>infinity</code> to disable.
</p>
</dd>
<dt class="hdlist1">
transform_header_name - see below
</dt>
<dd>
<p>
A function that will be applied to all header names before they
are sent to the server. Gun assumes that all header names are in
lower case. This function is useful if you, for example, need to
re-case header names in the event that the server incorrectly
considers the case of header names to be significant.
</p>
</dd>
<dt class="hdlist1">
version (<code>'HTTP/1.1'</code>)
</dt>
<dd>
<p>
HTTP version to use.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_http2_opts">http2_opts()</h3>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">http2_opts</span></span>() <span style="color: #990000">::</span> #{
    <span style="color: #0000FF">keepalive</span> <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000000">timeout</span></span>()
}</tt></pre></div></div>
<div class="paragraph"><p>Configuration for the HTTP/2 protocol.</p></div>
<div class="paragraph"><p>The default value is given next to the option name:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
keepalive (5000)
</dt>
<dd>
<p>
Time between pings in milliseconds.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_opts">opts()</h3>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">opts</span></span>() <span style="color: #990000">::</span> #{
    <span style="color: #0000FF">connect_timeout</span> <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000000">timeout</span></span>(),
    <span style="color: #0000FF">http_opts</span>       <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000000">http_opts</span></span>(),
    <span style="color: #0000FF">http2_opts</span>      <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000000">http2_opts</span></span>(),
    <span style="color: #0000FF">protocols</span>       <span style="color: #990000">=&gt;</span> [<span style="color: #FF6600">http</span> | <span style="color: #FF6600">http2</span>],
    <span style="color: #0000FF">retry</span>           <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000000">non_neg_integer</span></span>(),
    <span style="color: #0000FF">retry_timeout</span>   <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000000">pos_integer</span></span>(),
    <span style="color: #0000FF">trace</span>           <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000000">boolean</span></span>(),
    <span style="color: #0000FF">transport</span>       <span style="color: #990000">=&gt;</span> <span style="color: #FF6600">tcp</span> | <span style="color: #FF6600">tls</span>,
    <span style="color: #0000FF">transport_opts</span>  <span style="color: #990000">=&gt;</span> [<span style="font-weight: bold"><span style="color: #000000">gen_tcp:connect_option</span></span>()] | [<span style="font-weight: bold"><span style="color: #000000">ssl:connect_option</span></span>()],
    <span style="color: #0000FF">ws_opts</span>         <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000000">ws_opts</span></span>()
}</tt></pre></div></div>
<div class="paragraph"><p>Configuration for the connection.</p></div>
<div class="paragraph"><p>The default value is given next to the option name:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
connect_timeout (infinity)
</dt>
<dd>
<p>
Connection timeout.
</p>
</dd>
<dt class="hdlist1">
http_opts (#{})
</dt>
<dd>
<p>
Options specific to the HTTP protocol.
</p>
</dd>
<dt class="hdlist1">
http2_opts (#{})
</dt>
<dd>
<p>
Options specific to the HTTP/2 protocol.
</p>
</dd>
<dt class="hdlist1">
protocols - see below
</dt>
<dd>
<p>
Ordered list of preferred protocols. When the transport is <code>tcp</code>,
this list must contain exactly one protocol. When the transport
is <code>tls</code>, this list must contain at least one protocol and will be
used to negotiate a protocol via ALPN. When the server does not
support ALPN then <code>http</code> will always be used. Defaults to
<code>[http]</code> when the transport is <code>tcp</code>, and <code>[http2, http]</code> when the
transport is <code>tls</code>.
</p>
</dd>
<dt class="hdlist1">
retry (5)
</dt>
<dd>
<p>
Number of times Gun will try to reconnect on failure before giving up.
</p>
</dd>
<dt class="hdlist1">
retry_timeout (5000)
</dt>
<dd>
<p>
Time between retries in milliseconds.
</p>
</dd>
<dt class="hdlist1">
trace (false)
</dt>
<dd>
<p>
Whether to enable <code>dbg</code> tracing of the connection process. Should
only be used during debugging.
</p>
</dd>
<dt class="hdlist1">
transport - see below
</dt>
<dd>
<p>
Whether to use TLS or plain TCP. The default varies depending on the
port used. Port 443 defaults to <code>tls</code>. All other ports default to <code>tcp</code>.
</p>
</dd>
<dt class="hdlist1">
transport_opts ([])
</dt>
<dd>
<p>
Transport options. They are TCP options or TLS options depending on
the selected transport.
</p>
</dd>
<dt class="hdlist1">
ws_opts (#{})
</dt>
<dd>
<p>
Options specific to the Websocket protocol.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_req_opts">req_opts()</h3>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">req_opts</span></span>() <span style="color: #990000">::</span> #{
    <span style="color: #0000FF">reply_to</span> <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000080">pid</span></span>()
}</tt></pre></div></div>
<div class="paragraph"><p>Configuration for a particular request.</p></div>
<div class="paragraph"><p>The default value is given next to the option name:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
reply_to (<code>self()</code>)
</dt>
<dd>
<p>
The pid of the process that will receive the response messages.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="_ws_opts">ws_opts()</h3>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #000000">ws_opts</span></span>() <span style="color: #990000">::</span> #{
    <span style="color: #0000FF">compress</span> <span style="color: #990000">=&gt;</span> <span style="font-weight: bold"><span style="color: #000000">boolean</span></span>()
}</tt></pre></div></div>
<div class="paragraph"><p>Configuration for the Websocket protocol.</p></div>
<div class="paragraph"><p>The default value is given next to the option name:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
compress &#8658; boolean()
</dt>
<dd>
<p>
Whether to enable permessage-deflate compression. This does
not guarantee that compression will be used as it is the
server that ultimately decides. Defaults to false.
</p>
</dd>
</dl></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also">See also</h2>
<div class="sectionbody">
<div class="paragraph"><p><a href="..">gun(7)</a></p></div>
</div>
</div>





</div>

<div class="span3 sidecol">


<h3>
	Gun
	1.0
	Function Reference
	
</h3>

<ul>
	
		<li><a href="/docs/en/gun/1.0/guide">User Guide</a></li>
	
	
		<li><a href="/docs/en/gun/1.0/manual">Function Reference</a></li>
	
	
</ul>

<h4 id="docs-nav">Navigation</h4>

<h4>Version select</h4>
<ul>
	
	
	
		<li><a href="/docs/en/gun/1.0/manual">1.0</a></li>
	
</ul>

</div>
</div>
</div>
</div>

      <footer>
        <div class="container">
          <div class="row">
            <div class="span6">
              <p id="scroll-top"><a href="#">↑ Scroll to top</a></p>
              <nav>
                <ul>
                  <li><a href="mailto:contact@ninenines.eu" title="Contact us">Contact us</a></li><li><a href="https://github.com/ninenines/ninenines.github.io" title="Github repository">Contribute to this site</a></li>
                </ul>
              </nav>
            </div>
            <div class="span6 credits">
               <p><img src="/img/footer_logo.png"></p>
               <p>Copyright &copy; Loïc Hoguin 2012-2018</p>
            </div>
          </div>
        </div>
      </footer>

    
    <script src="/js/custom.js"></script>
  </body>
</html>


